# https://taskfile.dev
version: "3"

tasks:
  release:
    desc: build and publish release
    cmds:
      - test {{.CLI_ARGS}}
      - test {{.TOKEN}}
      # https://www.npmjs.com/settings/orsinium/tokens/
      - npm config set //registry.npmjs.org/:_authToken {{.TOKEN}}
      - grep -F '"{{.CLI_ARGS}}"' package.json
      - npm publish
      - git tag {{.CLI_ARGS}}
      - git push
      - git push --tags
      - gh release create --generate-notes {{.CLI_ARGS}}
